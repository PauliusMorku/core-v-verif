# Experimental CSR access test
# Generated by gen_csr_test.py (part of riscv-dv)
# Manual edits to fit with BSP and enhance debug
.include "user_define.h"
.section .text.start
.globl _start
.section .text
#.include "user_init.s"
.type _start, @function

_start:
    j _start_main

.globl _start_main
.section .text
_start_main:


############################################
#
# Generated code starts here generated...
#
############################################

	# misa
	li x5, 0xa5a5a5a5
	csrrw x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrw x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x6ddad949
	csrrw x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0xa5a5a5a5
	csrrs x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrs x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x1c5ac842
	csrrs x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0xa5a5a5a5
	csrrc x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrc x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	li x5, 0x58650439
	csrrc x15, 769, x5
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrwi x15, 769, 0b00101
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrwi x15, 769, 0b11010
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrwi x15, 769, 0b10010
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrsi x15, 769, 0b00101
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrsi x15, 769, 0b11010
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrsi x15, 769, 0b11100
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrci x15, 769, 0b00101
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrci x15, 769, 0b11010
	li x5, 0x40801104
	bne x5, x15, csr_fail
	csrrci x15, 769, 0b10111
	li x5, 0x40801104
	bne x5, x15, csr_fail
	# mscratch
	li x5, 0xa5a5a5a5
	csrrw x15, 832, x5
	li x5, 0x00000000
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrw x15, 832, x5
	li x5, 0xa5a5a5a5
	bne x5, x15, csr_fail
	li x5, 0xb7632740
	csrrw x15, 832, x5
	li x5, 0x5a5a5a5a
	bne x5, x15, csr_fail
	li x5, 0xa5a5a5a5
	csrrs x15, 832, x5
	li x5, 0xb7632740
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrs x15, 832, x5
	li x5, 0xb7e7a7e5
	bne x5, x15, csr_fail
	li x5, 0x0fa96376
	csrrs x15, 832, x5
	li x5, 0xffffffff
	bne x5, x15, csr_fail
	li x5, 0xa5a5a5a5
	csrrc x15, 832, x5
	li x5, 0xffffffff
	bne x5, x15, csr_fail
	li x5, 0x5a5a5a5a
	csrrc x15, 832, x5
	li x5, 0x5a5a5a5a
	bne x5, x15, csr_fail
	li x5, 0xdc8f28d8
	csrrc x15, 832, x5
	li x5, 0x00000000
	bne x5, x15, csr_fail
	csrrwi x15, 832, 0b00101
	li x5, 0x00000000
	bne x5, x15, csr_fail
	csrrwi x15, 832, 0b11010
	li x5, 0x00000005
	bne x5, x15, csr_fail
	csrrwi x15, 832, 0b00011
	li x5, 0x0000001a
	bne x5, x15, csr_fail
	csrrsi x15, 832, 0b00101
	li x5, 0x00000003
	bne x5, x15, csr_fail
	csrrsi x15, 832, 0b11010
	li x5, 0x00000007
	bne x5, x15, csr_fail
	csrrsi x15, 832, 0b10100
	li x5, 0x0000001f
	bne x5, x15, csr_fail
	csrrci x15, 832, 0b00101
	li x5, 0x0000001f
	bne x5, x15, csr_fail
	csrrci x15, 832, 0b11010
	li x5, 0x0000001a
	bne x5, x15, csr_fail
	csrrci x15, 832, 0b11101
	li x5, 0x00000000
	bne x5, x15, csr_fail
	csrr x15, 832
	li x5, 0x00000000
	bne x5, x15, csr_fail

############################################
#
# Manually generated
#
############################################
test_done:
    lui a0,print_port>>12
    addi a1,zero,'\n'
    sw a1,0(a0)
    addi a1,zero,'C'
    sw a1,0(a0)
    addi a1,zero,'V'
    sw a1,0(a0)
    addi a1,zero,'3'
    sw a1,0(a0)
    addi a1,zero,'2'
    sw a1,0(a0)
    addi a1,zero,' '
    sw a1,0(a0)
    addi a1,zero,'D'
    sw a1,0(a0)
    addi a1,zero,'O'
    sw a1,0(a0)
    addi a1,zero,'N'
    sw a1,0(a0)
    addi a1,zero,'E'
    sw a1,0(a0)
    addi a1,zero,'\n'
    sw a1,0(a0)
    sw a1,0(a0)

csr_pass:
    li x18, 123456789
    li x17, 0x20000000
    sw x18,0(x17)
    wfi

csr_fail:
    lui a0,print_port>>12
    addi a1,zero,'\n'
    sw a1,0(a0)
    addi a1,zero,'C'
    sw a1,0(a0)
    addi a1,zero,'V'
    sw a1,0(a0)
    addi a1,zero,'3'
    sw a1,0(a0)
    addi a1,zero,'2'
    sw a1,0(a0)
    addi a1,zero,' '
    sw a1,0(a0)
    addi a1,zero,'F'
    sw a1,0(a0)
    addi a1,zero,'A'
    sw a1,0(a0)
    addi a1,zero,'I'
    sw a1,0(a0)
    addi a1,zero,'L'
    sw a1,0(a0)
    addi a1,zero,'\n'
    sw a1,0(a0)
    sw a1,0(a0)

    li x18, 1
    li x17, 0x20000000
    sw x18,0(x17)
    wfi
